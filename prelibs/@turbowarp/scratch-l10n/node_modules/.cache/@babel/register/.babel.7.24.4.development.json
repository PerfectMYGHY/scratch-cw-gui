{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Administrator\\\\source\\\\repos\\\\PerfectMYGHY\\\\scratch\\\\node_modules\\\\scratch-gui\\\\node_modules\\\\@turbowarp\\\\scratch-l10n\\\\scripts\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Administrator\\\\source\\\\repos\\\\PerfectMYGHY\\\\scratch\\\\node_modules\\\\scratch-gui\\\\node_modules\\\\@turbowarp\\\\scratch-l10n\",\"filename\":\"C:\\\\Users\\\\Administrator\\\\source\\\\repos\\\\PerfectMYGHY\\\\scratch\\\\node_modules\\\\scratch-gui\\\\node_modules\\\\@turbowarp\\\\scratch-l10n\\\\scripts\\\\tw-pull.js\",\"targets\":{\"chrome\":\"70.0.0\",\"edge\":\"18.0.0\",\"firefox\":\"68.0.0\",\"ios\":\"12.0.0\",\"safari\":\"12.0.0\"},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Administrator\\\\source\\\\repos\\\\PerfectMYGHY\\\\scratch\\\\node_modules\\\\scratch-gui\\\\node_modules\\\\@turbowarp\\\\scratch-l10n\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.4:development":{"value":{"code":"#!/usr/bin/env babel-node\nimport pathUtil from 'node:path';\nimport fs from 'node:fs';\nimport { txPull, txGetResourceStatistics } from '../lib/transifex';\nimport { supportedLocales, scratchToTransifex } from './tw-locales';\nimport { batchMap } from '../lib/batch.js';\n\n/* eslint-disable valid-jsdoc */\n\nconst PROJECT = 'turbowarp';\nconst CONCURRENCY_LIMIT = 36;\nconst SOURCE_LOCALE = 'en';\n\n/**\n * Not sure how to do this in JSDoc\n * @template T\n * @typedef {Record<string, T>} NestedRecord<T>\n */\n\n/**\n * Normalizes messages in the following ways by converting objects with context to just strings,\n * and ensures that the order of keys is consistent.\n * @param {NestedRecord<string | {string: string}>} messages\n * @returns {NestedRecord<string>}\n */\nconst normalizeMessages = messages => {\n  const result = {};\n  for (const id of Object.keys(messages).sort()) {\n    const string = messages[id];\n    if (typeof string === 'string') {\n      // Don't touch normal strings.\n      result[id] = string;\n    } else if (typeof string.string === 'string') {\n      // Convert structured strings with context to normal strings.\n      result[id] = string.string;\n    } else {\n      // Recurse into nested message objects.\n      result[id] = normalizeMessages(string);\n    }\n  }\n  return result;\n};\n\n/**\n * @param {NestedRecord<string>} localeMessages\n * @param {NestedRecord<string>} sourceMessages\n * @returns {NestedRecord<string>}\n */\nconst removeRedundantMessages = (localeMessages, sourceMessages) => {\n  const result = {};\n  for (const [messageId, messageContent] of Object.entries(localeMessages)) {\n    const string = messageContent;\n    const sourceString = sourceMessages[messageId];\n    if (typeof string === 'string') {\n      // Copy strings that do not exactly match their English counterpart.\n      if (string !== sourceString) {\n        result[messageId] = string;\n      }\n    } else {\n      // Recurse into nested objects.\n      const nested = removeRedundantMessages(string, sourceString);\n      if (Object.keys(nested).length !== 0) {\n        result[messageId] = nested;\n      }\n    }\n  }\n  return result;\n};\n\n/**\n * @param {string[]} locales\n */\nconst createProgressPrinter = locales => {\n  const RESET = `\\u001b[0m`;\n  const BOLD = `\\u001b[1m`;\n  const GRAY = '\\u001b[90m';\n  const BLUE = `\\u001b[34m`;\n  const GREEN = '\\u001b[32m';\n  const CLEAR = '\\u001b[0k';\n  const NOT_STARTED = 0;\n  const STARTED = 1;\n  const FINISHED = 2;\n  let ended = false;\n  const states = {};\n  for (const locale of locales) {\n    states[locale] = NOT_STARTED;\n  }\n  const print = () => {\n    if (ended) {\n      return;\n    }\n    const items = Object.entries(states).map(([locale, state]) => {\n      let color = '??';\n      if (state === NOT_STARTED) color = GRAY;\n      if (state === STARTED) color = BLUE;\n      if (state === FINISHED) color = BOLD + GREEN;\n      return `${color}${locale}${RESET}`;\n    });\n    const total = locales.length;\n    const totalFinished = Object.values(states).filter(i => i === FINISHED).length;\n    process.stdout.write(`\\r${CLEAR}${items.join(' ')}${RESET} ${totalFinished}/${total}`);\n  };\n  const startedItem = locale => {\n    states[locale] = STARTED;\n    print();\n  };\n  const finishedItem = locale => {\n    states[locale] = FINISHED;\n    print();\n  };\n  const end = () => {\n    ended = true;\n    // Move cursor to own line.\n    console.log('');\n  };\n  print();\n  return {\n    startedItem,\n    finishedItem,\n    end\n  };\n};\n\n/**\n * @param {string} resource Name of Transifex resource\n * @param {number} requiredCompletion Number from 0-1 indicating what % of strings must be translated.\n *  Locales that do not meet this threshold will not be included in the result.\n * @returns {Promise<Record<string, Record<string, string>>} Does not include source messages.\n */\nconst pullResource = async (resource, requiredCompletion) => {\n  console.log(`Pulling ${resource}...`);\n  const transifexStatistics = await txGetResourceStatistics(PROJECT, resource);\n  const totalStrings = transifexStatistics[SOURCE_LOCALE];\n  const threshold = Math.max(1, Math.round(totalStrings * requiredCompletion));\n  const localesToFetch = Object.keys(supportedLocales).filter(locale => {\n    const transifexLocale = scratchToTransifex[locale] || locale;\n    const translatedStrings = transifexStatistics[transifexLocale];\n    if (typeof translatedStrings !== 'number') {\n      throw new Error(`Missing locale ${supportedLocales[locale].name} (${locale}) in ${resource}`);\n    }\n    return translatedStrings >= threshold;\n  });\n  const progress = createProgressPrinter(localesToFetch);\n  const values = await batchMap(localesToFetch, CONCURRENCY_LIMIT, async locale => {\n    progress.startedItem(locale);\n    try {\n      const messages = await txPull(PROJECT, resource, scratchToTransifex[locale] || locale);\n      progress.finishedItem(locale);\n      return {\n        scratchLocale: locale,\n        messages: normalizeMessages(messages)\n      };\n    } catch (error) {\n      progress.end();\n      // Transifex's error messages sometimes lack enough detail, so we will include\n      // some extra information.\n      console.error(`Could not fetch messages for locale: ${locale}`);\n      throw error;\n    }\n  });\n  const sourceMessages = values.find(i => i.scratchLocale === SOURCE_LOCALE).messages;\n  const result = {};\n  for (const pulled of values) {\n    const slimmedMessages = removeRedundantMessages(pulled.messages, sourceMessages);\n    if (Object.keys(slimmedMessages).length > 0) {\n      result[pulled.scratchLocale.toLowerCase()] = slimmedMessages;\n    }\n  }\n  progress.end();\n  return result;\n};\n\n/**\n * @param {string} path\n * @returns {boolean}\n */\nconst isDirectorySync = path => {\n  try {\n    const stat = fs.statSync(path);\n    return stat.isDirectory();\n  } catch (e) {\n    if (e.code === 'ENOENT') {\n      return false;\n    }\n    throw e;\n  }\n};\n\n/**\n * @param {NestedRecord<string, string>} messages\n * @returns {Record<string, string>}\n */\nconst generateSmallestLocaleNamesMap = messages => {\n  const lowercaseSupportedLocales = {};\n  for (const [locale, value] of Object.entries(supportedLocales)) {\n    lowercaseSupportedLocales[locale.toLowerCase()] = value;\n  }\n  const result = {\n    [SOURCE_LOCALE]: supportedLocales[SOURCE_LOCALE].name\n  };\n  for (const locale of Object.keys(messages)) {\n    result[locale] = lowercaseSupportedLocales[locale].name;\n  }\n  return result;\n};\nconst pullGui = async () => {\n  const scratchGui = pathUtil.join(__dirname, '../../scratch-gui');\n  if (!isDirectorySync(scratchGui)) {\n    console.log('Skipping editor; could not find scratch-gui.');\n    return;\n  }\n  const guiTranslationsFile = pathUtil.join(scratchGui, 'src/lib/tw-translations/generated-translations.json');\n  // These translations build upon scratch-l10n, so the threshold should be 0.\n  const guiTranslations = await pullResource('guijson', 0);\n  fs.writeFileSync(guiTranslationsFile, JSON.stringify(guiTranslations, null, 4));\n  const addonsTranslationsFile = pathUtil.join(scratchGui, 'src/addons/settings/translations.json');\n  const addonsTranslations = await pullResource('addonsjson', 0.7);\n  fs.writeFileSync(addonsTranslationsFile, JSON.stringify(addonsTranslations, null, 4));\n};\nconst pullPackager = async () => {\n  const packager = pathUtil.join(__dirname, '../../packager');\n  if (!isDirectorySync(packager)) {\n    console.log('Skipping packager; could not find packager.');\n    return;\n  }\n  const translations = await pullResource('packagerjson', 0.5);\n\n  // Delete old JSON files. Some languages that were previously supported might no longer be.\n  const localesDirectory = pathUtil.join(packager, 'src', 'locales');\n  for (const name of fs.readdirSync(localesDirectory)) {\n    if (name.endsWith('.json') && name !== 'en.json') {\n      fs.unlinkSync(pathUtil.join(localesDirectory, name));\n    }\n  }\n\n  // Write the individual JSON files\n  for (const [locale, messages] of Object.entries(translations)) {\n    const path = pathUtil.join(localesDirectory, `${locale}.json`);\n    fs.writeFileSync(path, JSON.stringify(messages, null, 4));\n  }\n\n  // Write the index.js manifest\n  const index = pathUtil.join(localesDirectory, 'index.js');\n  const oldContent = fs.readFileSync(index, 'utf-8');\n  const newContent = oldContent.replace(/\\/\\*===\\*\\/[\\s\\S]+\\/\\*===\\*\\//m, `/*===*/\\n${Object.keys(translations).map(i => `  ${JSON.stringify(i)}: () => require(${JSON.stringify(`./${i}.json`)})`).join(',\\n')},\\n  /*===*/`);\n  fs.writeFileSync(index, newContent);\n\n  // Write locale-names.json\n  const localeNames = generateSmallestLocaleNamesMap(translations);\n  fs.writeFileSync(pathUtil.join(localesDirectory, 'locale-names.json'), JSON.stringify(localeNames, null, 4));\n};\nconst pullDesktop = async () => {\n  const desktop = pathUtil.join(__dirname, '../../turbowarp-desktop');\n  if (!isDirectorySync(desktop)) {\n    console.log('Skipping desktop; could not find turbowarp-desktop.');\n    return;\n  }\n\n  // Desktop app translations\n  const desktopTranslations = await pullResource('desktopnewjson', 0.5);\n  fs.writeFileSync(pathUtil.join(desktop, 'src-main/l10n/generated-translations.json'), JSON.stringify(desktopTranslations, null, 4));\n\n  // Website translations\n  const webTranslations = await pullResource('desktopturbowarporg-redesign', 0.7);\n  const localeNames = generateSmallestLocaleNamesMap(webTranslations);\n  const indexHtml = pathUtil.join(desktop, 'docs', 'index.html');\n  const oldContent = fs.readFileSync(indexHtml, 'utf-8');\n  const newContent = oldContent.replace(/ *<!-- L10N_START -->[\\s\\S]*?<!-- L10N_END -->/gm, ['<!-- L10N_START -->', ...Object.entries(webTranslations).map(([locale, data]) => `<script type=\"generated-translations\" data-locale=\"${locale}\">${JSON.stringify(data)}</script>`), '<!-- L10N_END -->'].map(line => `    ${line}`).join('\\n')).replace(/<script type=\"generated-locale-names\">[\\s\\S]+?<\\/script>/, `<script type=\"generated-locale-names\">${JSON.stringify(localeNames)}</script>`);\n  fs.writeFileSync(indexHtml, newContent);\n  const storeListings = await pullResource('store-listingsyaml', 1);\n  fs.writeFileSync(pathUtil.join(desktop, 'store-listings/imported.json'), JSON.stringify(storeListings, null, 4));\n};\nconst pullExtensions = async () => {\n  const extensions = pathUtil.join(__dirname, '../../extensions');\n  if (!isDirectorySync(extensions)) {\n    console.log('Skipping extensions; could not find extensions.');\n    return;\n  }\n  const metadataTranslations = await pullResource('extension-metadata', 0);\n  fs.writeFileSync(pathUtil.join(extensions, 'translations/extension-metadata.json'), JSON.stringify(metadataTranslations, null, 4));\n  const runtimeTranslations = await pullResource('extensions', 0);\n  fs.writeFileSync(pathUtil.join(extensions, 'translations/extension-runtime.json'), JSON.stringify(runtimeTranslations, null, 4));\n};\nconst pullEverything = async () => {\n  try {\n    console.log('DOWNLOADING from Transifex...');\n    await pullGui();\n    await pullPackager();\n    await pullDesktop();\n    await pullExtensions();\n  } catch (e) {\n    console.error(e);\n    process.exit(1);\n  }\n};\npullEverything();\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoVXRpbCIsImZzIiwidHhQdWxsIiwidHhHZXRSZXNvdXJjZVN0YXRpc3RpY3MiLCJzdXBwb3J0ZWRMb2NhbGVzIiwic2NyYXRjaFRvVHJhbnNpZmV4IiwiYmF0Y2hNYXAiLCJQUk9KRUNUIiwiQ09OQ1VSUkVOQ1lfTElNSVQiLCJTT1VSQ0VfTE9DQUxFIiwibm9ybWFsaXplTWVzc2FnZXMiLCJtZXNzYWdlcyIsInJlc3VsdCIsImlkIiwiT2JqZWN0Iiwia2V5cyIsInNvcnQiLCJzdHJpbmciLCJyZW1vdmVSZWR1bmRhbnRNZXNzYWdlcyIsImxvY2FsZU1lc3NhZ2VzIiwic291cmNlTWVzc2FnZXMiLCJtZXNzYWdlSWQiLCJtZXNzYWdlQ29udGVudCIsImVudHJpZXMiLCJzb3VyY2VTdHJpbmciLCJuZXN0ZWQiLCJsZW5ndGgiLCJjcmVhdGVQcm9ncmVzc1ByaW50ZXIiLCJsb2NhbGVzIiwiUkVTRVQiLCJCT0xEIiwiR1JBWSIsIkJMVUUiLCJHUkVFTiIsIkNMRUFSIiwiTk9UX1NUQVJURUQiLCJTVEFSVEVEIiwiRklOSVNIRUQiLCJlbmRlZCIsInN0YXRlcyIsImxvY2FsZSIsInByaW50IiwiaXRlbXMiLCJtYXAiLCJzdGF0ZSIsImNvbG9yIiwidG90YWwiLCJ0b3RhbEZpbmlzaGVkIiwidmFsdWVzIiwiZmlsdGVyIiwiaSIsInByb2Nlc3MiLCJzdGRvdXQiLCJ3cml0ZSIsImpvaW4iLCJzdGFydGVkSXRlbSIsImZpbmlzaGVkSXRlbSIsImVuZCIsImNvbnNvbGUiLCJsb2ciLCJwdWxsUmVzb3VyY2UiLCJyZXNvdXJjZSIsInJlcXVpcmVkQ29tcGxldGlvbiIsInRyYW5zaWZleFN0YXRpc3RpY3MiLCJ0b3RhbFN0cmluZ3MiLCJ0aHJlc2hvbGQiLCJNYXRoIiwibWF4Iiwicm91bmQiLCJsb2NhbGVzVG9GZXRjaCIsInRyYW5zaWZleExvY2FsZSIsInRyYW5zbGF0ZWRTdHJpbmdzIiwiRXJyb3IiLCJuYW1lIiwicHJvZ3Jlc3MiLCJzY3JhdGNoTG9jYWxlIiwiZXJyb3IiLCJmaW5kIiwicHVsbGVkIiwic2xpbW1lZE1lc3NhZ2VzIiwidG9Mb3dlckNhc2UiLCJpc0RpcmVjdG9yeVN5bmMiLCJwYXRoIiwic3RhdCIsInN0YXRTeW5jIiwiaXNEaXJlY3RvcnkiLCJlIiwiY29kZSIsImdlbmVyYXRlU21hbGxlc3RMb2NhbGVOYW1lc01hcCIsImxvd2VyY2FzZVN1cHBvcnRlZExvY2FsZXMiLCJ2YWx1ZSIsInB1bGxHdWkiLCJzY3JhdGNoR3VpIiwiX19kaXJuYW1lIiwiZ3VpVHJhbnNsYXRpb25zRmlsZSIsImd1aVRyYW5zbGF0aW9ucyIsIndyaXRlRmlsZVN5bmMiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkb25zVHJhbnNsYXRpb25zRmlsZSIsImFkZG9uc1RyYW5zbGF0aW9ucyIsInB1bGxQYWNrYWdlciIsInBhY2thZ2VyIiwidHJhbnNsYXRpb25zIiwibG9jYWxlc0RpcmVjdG9yeSIsInJlYWRkaXJTeW5jIiwiZW5kc1dpdGgiLCJ1bmxpbmtTeW5jIiwiaW5kZXgiLCJvbGRDb250ZW50IiwicmVhZEZpbGVTeW5jIiwibmV3Q29udGVudCIsInJlcGxhY2UiLCJsb2NhbGVOYW1lcyIsInB1bGxEZXNrdG9wIiwiZGVza3RvcCIsImRlc2t0b3BUcmFuc2xhdGlvbnMiLCJ3ZWJUcmFuc2xhdGlvbnMiLCJpbmRleEh0bWwiLCJkYXRhIiwibGluZSIsInN0b3JlTGlzdGluZ3MiLCJwdWxsRXh0ZW5zaW9ucyIsImV4dGVuc2lvbnMiLCJtZXRhZGF0YVRyYW5zbGF0aW9ucyIsInJ1bnRpbWVUcmFuc2xhdGlvbnMiLCJwdWxsRXZlcnl0aGluZyIsImV4aXQiXSwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcQWRtaW5pc3RyYXRvclxcc291cmNlXFxyZXBvc1xcUGVyZmVjdE1ZR0hZXFxzY3JhdGNoXFxub2RlX21vZHVsZXNcXHNjcmF0Y2gtZ3VpXFxub2RlX21vZHVsZXNcXEB0dXJib3dhcnBcXHNjcmF0Y2gtbDEwblxcc2NyaXB0c1xcIiwic291cmNlcyI6WyJ0dy1wdWxsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIiMhL3Vzci9iaW4vZW52IGJhYmVsLW5vZGVcblxuaW1wb3J0IHBhdGhVdGlsIGZyb20gJ25vZGU6cGF0aCc7XG5pbXBvcnQgZnMgZnJvbSAnbm9kZTpmcyc7XG5pbXBvcnQge3R4UHVsbCwgdHhHZXRSZXNvdXJjZVN0YXRpc3RpY3N9IGZyb20gJy4uL2xpYi90cmFuc2lmZXgnO1xuaW1wb3J0IHtzdXBwb3J0ZWRMb2NhbGVzLCBzY3JhdGNoVG9UcmFuc2lmZXh9IGZyb20gJy4vdHctbG9jYWxlcyc7XG5pbXBvcnQge2JhdGNoTWFwfSBmcm9tICcuLi9saWIvYmF0Y2guanMnO1xuXG4vKiBlc2xpbnQtZGlzYWJsZSB2YWxpZC1qc2RvYyAqL1xuXG5jb25zdCBQUk9KRUNUID0gJ3R1cmJvd2FycCc7XG5jb25zdCBDT05DVVJSRU5DWV9MSU1JVCA9IDM2O1xuY29uc3QgU09VUkNFX0xPQ0FMRSA9ICdlbic7XG5cbi8qKlxuICogTm90IHN1cmUgaG93IHRvIGRvIHRoaXMgaW4gSlNEb2NcbiAqIEB0ZW1wbGF0ZSBUXG4gKiBAdHlwZWRlZiB7UmVjb3JkPHN0cmluZywgVD59IE5lc3RlZFJlY29yZDxUPlxuICovXG5cbi8qKlxuICogTm9ybWFsaXplcyBtZXNzYWdlcyBpbiB0aGUgZm9sbG93aW5nIHdheXMgYnkgY29udmVydGluZyBvYmplY3RzIHdpdGggY29udGV4dCB0byBqdXN0IHN0cmluZ3MsXG4gKiBhbmQgZW5zdXJlcyB0aGF0IHRoZSBvcmRlciBvZiBrZXlzIGlzIGNvbnNpc3RlbnQuXG4gKiBAcGFyYW0ge05lc3RlZFJlY29yZDxzdHJpbmcgfCB7c3RyaW5nOiBzdHJpbmd9Pn0gbWVzc2FnZXNcbiAqIEByZXR1cm5zIHtOZXN0ZWRSZWNvcmQ8c3RyaW5nPn1cbiAqL1xuY29uc3Qgbm9ybWFsaXplTWVzc2FnZXMgPSBtZXNzYWdlcyA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBpZCBvZiBPYmplY3Qua2V5cyhtZXNzYWdlcykuc29ydCgpKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZyA9IG1lc3NhZ2VzW2lkXTtcbiAgICAgICAgaWYgKHR5cGVvZiBzdHJpbmcgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAvLyBEb24ndCB0b3VjaCBub3JtYWwgc3RyaW5ncy5cbiAgICAgICAgICAgIHJlc3VsdFtpZF0gPSBzdHJpbmc7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHN0cmluZy5zdHJpbmcgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAvLyBDb252ZXJ0IHN0cnVjdHVyZWQgc3RyaW5ncyB3aXRoIGNvbnRleHQgdG8gbm9ybWFsIHN0cmluZ3MuXG4gICAgICAgICAgICByZXN1bHRbaWRdID0gc3RyaW5nLnN0cmluZztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFJlY3Vyc2UgaW50byBuZXN0ZWQgbWVzc2FnZSBvYmplY3RzLlxuICAgICAgICAgICAgcmVzdWx0W2lkXSA9IG5vcm1hbGl6ZU1lc3NhZ2VzKHN0cmluZyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtOZXN0ZWRSZWNvcmQ8c3RyaW5nPn0gbG9jYWxlTWVzc2FnZXNcbiAqIEBwYXJhbSB7TmVzdGVkUmVjb3JkPHN0cmluZz59IHNvdXJjZU1lc3NhZ2VzXG4gKiBAcmV0dXJucyB7TmVzdGVkUmVjb3JkPHN0cmluZz59XG4gKi9cbmNvbnN0IHJlbW92ZVJlZHVuZGFudE1lc3NhZ2VzID0gKGxvY2FsZU1lc3NhZ2VzLCBzb3VyY2VNZXNzYWdlcykgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgW21lc3NhZ2VJZCwgbWVzc2FnZUNvbnRlbnRdIG9mIE9iamVjdC5lbnRyaWVzKGxvY2FsZU1lc3NhZ2VzKSkge1xuICAgICAgICBjb25zdCBzdHJpbmcgPSBtZXNzYWdlQ29udGVudDtcbiAgICAgICAgY29uc3Qgc291cmNlU3RyaW5nID0gc291cmNlTWVzc2FnZXNbbWVzc2FnZUlkXTtcbiAgICAgICAgaWYgKHR5cGVvZiBzdHJpbmcgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAvLyBDb3B5IHN0cmluZ3MgdGhhdCBkbyBub3QgZXhhY3RseSBtYXRjaCB0aGVpciBFbmdsaXNoIGNvdW50ZXJwYXJ0LlxuICAgICAgICAgICAgaWYgKHN0cmluZyAhPT0gc291cmNlU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W21lc3NhZ2VJZF0gPSBzdHJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBSZWN1cnNlIGludG8gbmVzdGVkIG9iamVjdHMuXG4gICAgICAgICAgICBjb25zdCBuZXN0ZWQgPSByZW1vdmVSZWR1bmRhbnRNZXNzYWdlcyhzdHJpbmcsIHNvdXJjZVN0cmluZyk7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMobmVzdGVkKS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbbWVzc2FnZUlkXSA9IG5lc3RlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBsb2NhbGVzXG4gKi9cbmNvbnN0IGNyZWF0ZVByb2dyZXNzUHJpbnRlciA9IGxvY2FsZXMgPT4ge1xuICAgIGNvbnN0IFJFU0VUID0gYFxcdTAwMWJbMG1gO1xuICAgIGNvbnN0IEJPTEQgPSBgXFx1MDAxYlsxbWA7XG4gICAgY29uc3QgR1JBWSA9ICdcXHUwMDFiWzkwbSc7XG4gICAgY29uc3QgQkxVRSA9IGBcXHUwMDFiWzM0bWA7XG4gICAgY29uc3QgR1JFRU4gPSAnXFx1MDAxYlszMm0nO1xuICAgIGNvbnN0IENMRUFSID0gJ1xcdTAwMWJbMGsnO1xuXG4gICAgY29uc3QgTk9UX1NUQVJURUQgPSAwO1xuICAgIGNvbnN0IFNUQVJURUQgPSAxO1xuICAgIGNvbnN0IEZJTklTSEVEID0gMjtcblxuICAgIGxldCBlbmRlZCA9IGZhbHNlO1xuICAgIGNvbnN0IHN0YXRlcyA9IHt9O1xuICAgIGZvciAoY29uc3QgbG9jYWxlIG9mIGxvY2FsZXMpIHtcbiAgICAgICAgc3RhdGVzW2xvY2FsZV0gPSBOT1RfU1RBUlRFRDtcbiAgICB9XG5cbiAgICBjb25zdCBwcmludCA9ICgpID0+IHtcbiAgICAgICAgaWYgKGVuZGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXRlbXMgPSBPYmplY3QuZW50cmllcyhzdGF0ZXMpLm1hcCgoW2xvY2FsZSwgc3RhdGVdKSA9PiB7XG4gICAgICAgICAgICBsZXQgY29sb3IgPSAnPz8nO1xuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBOT1RfU1RBUlRFRCkgY29sb3IgPSBHUkFZO1xuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBTVEFSVEVEKSBjb2xvciA9IEJMVUU7XG4gICAgICAgICAgICBpZiAoc3RhdGUgPT09IEZJTklTSEVEKSBjb2xvciA9IEJPTEQgKyBHUkVFTjtcbiAgICAgICAgICAgIHJldHVybiBgJHtjb2xvcn0ke2xvY2FsZX0ke1JFU0VUfWA7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB0b3RhbCA9IGxvY2FsZXMubGVuZ3RoO1xuICAgICAgICBjb25zdCB0b3RhbEZpbmlzaGVkID0gT2JqZWN0LnZhbHVlcyhzdGF0ZXMpLmZpbHRlcihpID0+IGkgPT09IEZJTklTSEVEKS5sZW5ndGg7XG4gICAgICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKGBcXHIke0NMRUFSfSR7aXRlbXMuam9pbignICcpfSR7UkVTRVR9ICR7dG90YWxGaW5pc2hlZH0vJHt0b3RhbH1gKTtcbiAgICB9O1xuXG4gICAgY29uc3Qgc3RhcnRlZEl0ZW0gPSBsb2NhbGUgPT4ge1xuICAgICAgICBzdGF0ZXNbbG9jYWxlXSA9IFNUQVJURUQ7XG4gICAgICAgIHByaW50KCk7XG4gICAgfTtcblxuICAgIGNvbnN0IGZpbmlzaGVkSXRlbSA9IGxvY2FsZSA9PiB7XG4gICAgICAgIHN0YXRlc1tsb2NhbGVdID0gRklOSVNIRUQ7XG4gICAgICAgIHByaW50KCk7XG4gICAgfTtcblxuICAgIGNvbnN0IGVuZCA9ICgpID0+IHtcbiAgICAgICAgZW5kZWQgPSB0cnVlO1xuICAgICAgICAvLyBNb3ZlIGN1cnNvciB0byBvd24gbGluZS5cbiAgICAgICAgY29uc29sZS5sb2coJycpO1xuICAgIH07XG5cbiAgICBwcmludCgpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0ZWRJdGVtLFxuICAgICAgICBmaW5pc2hlZEl0ZW0sXG4gICAgICAgIGVuZFxuICAgIH07XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSByZXNvdXJjZSBOYW1lIG9mIFRyYW5zaWZleCByZXNvdXJjZVxuICogQHBhcmFtIHtudW1iZXJ9IHJlcXVpcmVkQ29tcGxldGlvbiBOdW1iZXIgZnJvbSAwLTEgaW5kaWNhdGluZyB3aGF0ICUgb2Ygc3RyaW5ncyBtdXN0IGJlIHRyYW5zbGF0ZWQuXG4gKiAgTG9jYWxlcyB0aGF0IGRvIG5vdCBtZWV0IHRoaXMgdGhyZXNob2xkIHdpbGwgbm90IGJlIGluY2x1ZGVkIGluIHRoZSByZXN1bHQuXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+Pn0gRG9lcyBub3QgaW5jbHVkZSBzb3VyY2UgbWVzc2FnZXMuXG4gKi9cbmNvbnN0IHB1bGxSZXNvdXJjZSA9IGFzeW5jIChyZXNvdXJjZSwgcmVxdWlyZWRDb21wbGV0aW9uKSA9PiB7XG4gICAgY29uc29sZS5sb2coYFB1bGxpbmcgJHtyZXNvdXJjZX0uLi5gKTtcblxuICAgIGNvbnN0IHRyYW5zaWZleFN0YXRpc3RpY3MgPSBhd2FpdCB0eEdldFJlc291cmNlU3RhdGlzdGljcyhQUk9KRUNULCByZXNvdXJjZSk7XG4gICAgY29uc3QgdG90YWxTdHJpbmdzID0gdHJhbnNpZmV4U3RhdGlzdGljc1tTT1VSQ0VfTE9DQUxFXTtcbiAgICBjb25zdCB0aHJlc2hvbGQgPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKHRvdGFsU3RyaW5ncyAqIHJlcXVpcmVkQ29tcGxldGlvbikpO1xuICAgIGNvbnN0IGxvY2FsZXNUb0ZldGNoID0gT2JqZWN0LmtleXMoc3VwcG9ydGVkTG9jYWxlcykuZmlsdGVyKGxvY2FsZSA9PiB7XG4gICAgICAgIGNvbnN0IHRyYW5zaWZleExvY2FsZSA9IHNjcmF0Y2hUb1RyYW5zaWZleFtsb2NhbGVdIHx8IGxvY2FsZTtcbiAgICAgICAgY29uc3QgdHJhbnNsYXRlZFN0cmluZ3MgPSB0cmFuc2lmZXhTdGF0aXN0aWNzW3RyYW5zaWZleExvY2FsZV07XG4gICAgICAgIGlmICh0eXBlb2YgdHJhbnNsYXRlZFN0cmluZ3MgIT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgbG9jYWxlICR7c3VwcG9ydGVkTG9jYWxlc1tsb2NhbGVdLm5hbWV9ICgke2xvY2FsZX0pIGluICR7cmVzb3VyY2V9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZWRTdHJpbmdzID49IHRocmVzaG9sZDtcbiAgICB9KTtcblxuICAgIGNvbnN0IHByb2dyZXNzID0gY3JlYXRlUHJvZ3Jlc3NQcmludGVyKGxvY2FsZXNUb0ZldGNoKTtcblxuICAgIGNvbnN0IHZhbHVlcyA9IGF3YWl0IGJhdGNoTWFwKGxvY2FsZXNUb0ZldGNoLCBDT05DVVJSRU5DWV9MSU1JVCwgYXN5bmMgbG9jYWxlID0+IHtcbiAgICAgICAgcHJvZ3Jlc3Muc3RhcnRlZEl0ZW0obG9jYWxlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgdHhQdWxsKFBST0pFQ1QsIHJlc291cmNlLCBzY3JhdGNoVG9UcmFuc2lmZXhbbG9jYWxlXSB8fCBsb2NhbGUpO1xuICAgICAgICAgICAgcHJvZ3Jlc3MuZmluaXNoZWRJdGVtKGxvY2FsZSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHNjcmF0Y2hMb2NhbGU6IGxvY2FsZSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogbm9ybWFsaXplTWVzc2FnZXMobWVzc2FnZXMpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcHJvZ3Jlc3MuZW5kKCk7XG4gICAgICAgICAgICAvLyBUcmFuc2lmZXgncyBlcnJvciBtZXNzYWdlcyBzb21ldGltZXMgbGFjayBlbm91Z2ggZGV0YWlsLCBzbyB3ZSB3aWxsIGluY2x1ZGVcbiAgICAgICAgICAgIC8vIHNvbWUgZXh0cmEgaW5mb3JtYXRpb24uXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBDb3VsZCBub3QgZmV0Y2ggbWVzc2FnZXMgZm9yIGxvY2FsZTogJHtsb2NhbGV9YCk7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3Qgc291cmNlTWVzc2FnZXMgPSB2YWx1ZXMuZmluZChpID0+IGkuc2NyYXRjaExvY2FsZSA9PT0gU09VUkNFX0xPQ0FMRSkubWVzc2FnZXM7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBwdWxsZWQgb2YgdmFsdWVzKSB7XG4gICAgICAgIGNvbnN0IHNsaW1tZWRNZXNzYWdlcyA9IHJlbW92ZVJlZHVuZGFudE1lc3NhZ2VzKHB1bGxlZC5tZXNzYWdlcywgc291cmNlTWVzc2FnZXMpO1xuICAgICAgICBpZiAoT2JqZWN0LmtleXMoc2xpbW1lZE1lc3NhZ2VzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXN1bHRbcHVsbGVkLnNjcmF0Y2hMb2NhbGUudG9Mb3dlckNhc2UoKV0gPSBzbGltbWVkTWVzc2FnZXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm9ncmVzcy5lbmQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmNvbnN0IGlzRGlyZWN0b3J5U3luYyA9IHBhdGggPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHN0YXQgPSBmcy5zdGF0U3luYyhwYXRoKTtcbiAgICAgICAgcmV0dXJuIHN0YXQuaXNEaXJlY3RvcnkoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChlLmNvZGUgPT09ICdFTk9FTlQnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZTtcbiAgICB9XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7TmVzdGVkUmVjb3JkPHN0cmluZywgc3RyaW5nPn0gbWVzc2FnZXNcbiAqIEByZXR1cm5zIHtSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+fVxuICovXG5jb25zdCBnZW5lcmF0ZVNtYWxsZXN0TG9jYWxlTmFtZXNNYXAgPSBtZXNzYWdlcyA9PiB7XG4gICAgY29uc3QgbG93ZXJjYXNlU3VwcG9ydGVkTG9jYWxlcyA9IHt9O1xuICAgIGZvciAoY29uc3QgW2xvY2FsZSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHN1cHBvcnRlZExvY2FsZXMpKSB7XG4gICAgICAgIGxvd2VyY2FzZVN1cHBvcnRlZExvY2FsZXNbbG9jYWxlLnRvTG93ZXJDYXNlKCldID0gdmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgW1NPVVJDRV9MT0NBTEVdOiBzdXBwb3J0ZWRMb2NhbGVzW1NPVVJDRV9MT0NBTEVdLm5hbWVcbiAgICB9O1xuICAgIGZvciAoY29uc3QgbG9jYWxlIG9mIE9iamVjdC5rZXlzKG1lc3NhZ2VzKSkge1xuICAgICAgICByZXN1bHRbbG9jYWxlXSA9IGxvd2VyY2FzZVN1cHBvcnRlZExvY2FsZXNbbG9jYWxlXS5uYW1lO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuY29uc3QgcHVsbEd1aSA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBzY3JhdGNoR3VpID0gcGF0aFV0aWwuam9pbihfX2Rpcm5hbWUsICcuLi8uLi9zY3JhdGNoLWd1aScpO1xuICAgIGlmICghaXNEaXJlY3RvcnlTeW5jKHNjcmF0Y2hHdWkpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTa2lwcGluZyBlZGl0b3I7IGNvdWxkIG5vdCBmaW5kIHNjcmF0Y2gtZ3VpLicpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZ3VpVHJhbnNsYXRpb25zRmlsZSA9IHBhdGhVdGlsLmpvaW4oc2NyYXRjaEd1aSwgJ3NyYy9saWIvdHctdHJhbnNsYXRpb25zL2dlbmVyYXRlZC10cmFuc2xhdGlvbnMuanNvbicpO1xuICAgIC8vIFRoZXNlIHRyYW5zbGF0aW9ucyBidWlsZCB1cG9uIHNjcmF0Y2gtbDEwbiwgc28gdGhlIHRocmVzaG9sZCBzaG91bGQgYmUgMC5cbiAgICBjb25zdCBndWlUcmFuc2xhdGlvbnMgPSBhd2FpdCBwdWxsUmVzb3VyY2UoJ2d1aWpzb24nLCAwKTtcbiAgICBmcy53cml0ZUZpbGVTeW5jKGd1aVRyYW5zbGF0aW9uc0ZpbGUsIEpTT04uc3RyaW5naWZ5KGd1aVRyYW5zbGF0aW9ucywgbnVsbCwgNCkpO1xuXG4gICAgY29uc3QgYWRkb25zVHJhbnNsYXRpb25zRmlsZSA9IHBhdGhVdGlsLmpvaW4oc2NyYXRjaEd1aSwgJ3NyYy9hZGRvbnMvc2V0dGluZ3MvdHJhbnNsYXRpb25zLmpzb24nKTtcbiAgICBjb25zdCBhZGRvbnNUcmFuc2xhdGlvbnMgPSBhd2FpdCBwdWxsUmVzb3VyY2UoJ2FkZG9uc2pzb24nLCAwLjcpO1xuICAgIGZzLndyaXRlRmlsZVN5bmMoYWRkb25zVHJhbnNsYXRpb25zRmlsZSwgSlNPTi5zdHJpbmdpZnkoYWRkb25zVHJhbnNsYXRpb25zLCBudWxsLCA0KSk7XG59O1xuXG5jb25zdCBwdWxsUGFja2FnZXIgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcGFja2FnZXIgPSBwYXRoVXRpbC5qb2luKF9fZGlybmFtZSwgJy4uLy4uL3BhY2thZ2VyJyk7XG4gICAgaWYgKCFpc0RpcmVjdG9yeVN5bmMocGFja2FnZXIpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTa2lwcGluZyBwYWNrYWdlcjsgY291bGQgbm90IGZpbmQgcGFja2FnZXIuJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0cmFuc2xhdGlvbnMgPSBhd2FpdCBwdWxsUmVzb3VyY2UoJ3BhY2thZ2VyanNvbicsIDAuNSk7XG5cbiAgICAvLyBEZWxldGUgb2xkIEpTT04gZmlsZXMuIFNvbWUgbGFuZ3VhZ2VzIHRoYXQgd2VyZSBwcmV2aW91c2x5IHN1cHBvcnRlZCBtaWdodCBubyBsb25nZXIgYmUuXG4gICAgY29uc3QgbG9jYWxlc0RpcmVjdG9yeSA9IHBhdGhVdGlsLmpvaW4ocGFja2FnZXIsICdzcmMnLCAnbG9jYWxlcycpO1xuICAgIGZvciAoY29uc3QgbmFtZSBvZiBmcy5yZWFkZGlyU3luYyhsb2NhbGVzRGlyZWN0b3J5KSkge1xuICAgICAgICBpZiAobmFtZS5lbmRzV2l0aCgnLmpzb24nKSAmJiBuYW1lICE9PSAnZW4uanNvbicpIHtcbiAgICAgICAgICAgIGZzLnVubGlua1N5bmMocGF0aFV0aWwuam9pbihsb2NhbGVzRGlyZWN0b3J5LCBuYW1lKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBXcml0ZSB0aGUgaW5kaXZpZHVhbCBKU09OIGZpbGVzXG4gICAgZm9yIChjb25zdCBbbG9jYWxlLCBtZXNzYWdlc10gb2YgT2JqZWN0LmVudHJpZXModHJhbnNsYXRpb25zKSkge1xuICAgICAgICBjb25zdCBwYXRoID0gcGF0aFV0aWwuam9pbihsb2NhbGVzRGlyZWN0b3J5LCBgJHtsb2NhbGV9Lmpzb25gKTtcbiAgICAgICAgZnMud3JpdGVGaWxlU3luYyhwYXRoLCBKU09OLnN0cmluZ2lmeShtZXNzYWdlcywgbnVsbCwgNCkpO1xuICAgIH1cblxuICAgIC8vIFdyaXRlIHRoZSBpbmRleC5qcyBtYW5pZmVzdFxuICAgIGNvbnN0IGluZGV4ID0gcGF0aFV0aWwuam9pbihsb2NhbGVzRGlyZWN0b3J5LCAnaW5kZXguanMnKTtcbiAgICBjb25zdCBvbGRDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGluZGV4LCAndXRmLTgnKTtcbiAgICBjb25zdCBuZXdDb250ZW50ID0gb2xkQ29udGVudC5yZXBsYWNlKC9cXC9cXCo9PT1cXCpcXC9bXFxzXFxTXStcXC9cXCo9PT1cXCpcXC8vbSwgYC8qPT09Ki9cXG4ke1xuICAgICAgICBPYmplY3Qua2V5cyh0cmFuc2xhdGlvbnMpXG4gICAgICAgICAgICAubWFwKGkgPT4gYCAgJHtKU09OLnN0cmluZ2lmeShpKX06ICgpID0+IHJlcXVpcmUoJHtKU09OLnN0cmluZ2lmeShgLi8ke2l9Lmpzb25gKX0pYClcbiAgICAgICAgICAgIC5qb2luKCcsXFxuJylcbiAgICB9LFxcbiAgLyo9PT0qL2ApO1xuICAgIGZzLndyaXRlRmlsZVN5bmMoaW5kZXgsIG5ld0NvbnRlbnQpO1xuXG4gICAgLy8gV3JpdGUgbG9jYWxlLW5hbWVzLmpzb25cbiAgICBjb25zdCBsb2NhbGVOYW1lcyA9IGdlbmVyYXRlU21hbGxlc3RMb2NhbGVOYW1lc01hcCh0cmFuc2xhdGlvbnMpO1xuICAgIGZzLndyaXRlRmlsZVN5bmMocGF0aFV0aWwuam9pbihsb2NhbGVzRGlyZWN0b3J5LCAnbG9jYWxlLW5hbWVzLmpzb24nKSwgSlNPTi5zdHJpbmdpZnkobG9jYWxlTmFtZXMsIG51bGwsIDQpKTtcbn07XG5cbmNvbnN0IHB1bGxEZXNrdG9wID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGRlc2t0b3AgPSBwYXRoVXRpbC5qb2luKF9fZGlybmFtZSwgJy4uLy4uL3R1cmJvd2FycC1kZXNrdG9wJyk7XG4gICAgaWYgKCFpc0RpcmVjdG9yeVN5bmMoZGVza3RvcCkpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NraXBwaW5nIGRlc2t0b3A7IGNvdWxkIG5vdCBmaW5kIHR1cmJvd2FycC1kZXNrdG9wLicpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRGVza3RvcCBhcHAgdHJhbnNsYXRpb25zXG4gICAgY29uc3QgZGVza3RvcFRyYW5zbGF0aW9ucyA9IGF3YWl0IHB1bGxSZXNvdXJjZSgnZGVza3RvcG5ld2pzb24nLCAwLjUpO1xuICAgIGZzLndyaXRlRmlsZVN5bmMoXG4gICAgICAgIHBhdGhVdGlsLmpvaW4oZGVza3RvcCwgJ3NyYy1tYWluL2wxMG4vZ2VuZXJhdGVkLXRyYW5zbGF0aW9ucy5qc29uJyksXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KGRlc2t0b3BUcmFuc2xhdGlvbnMsIG51bGwsIDQpXG4gICAgKTtcblxuICAgIC8vIFdlYnNpdGUgdHJhbnNsYXRpb25zXG4gICAgY29uc3Qgd2ViVHJhbnNsYXRpb25zID0gYXdhaXQgcHVsbFJlc291cmNlKCdkZXNrdG9wdHVyYm93YXJwb3JnLXJlZGVzaWduJywgMC43KTtcbiAgICBjb25zdCBsb2NhbGVOYW1lcyA9IGdlbmVyYXRlU21hbGxlc3RMb2NhbGVOYW1lc01hcCh3ZWJUcmFuc2xhdGlvbnMpO1xuICAgIGNvbnN0IGluZGV4SHRtbCA9IHBhdGhVdGlsLmpvaW4oZGVza3RvcCwgJ2RvY3MnLCAnaW5kZXguaHRtbCcpO1xuICAgIGNvbnN0IG9sZENvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoaW5kZXhIdG1sLCAndXRmLTgnKTtcbiAgICBjb25zdCBuZXdDb250ZW50ID0gb2xkQ29udGVudFxuICAgICAgICAucmVwbGFjZShcbiAgICAgICAgICAgIC8gKjwhLS0gTDEwTl9TVEFSVCAtLT5bXFxzXFxTXSo/PCEtLSBMMTBOX0VORCAtLT4vZ20sXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgJzwhLS0gTDEwTl9TVEFSVCAtLT4nLFxuICAgICAgICAgICAgICAgIC4uLk9iamVjdC5lbnRyaWVzKHdlYlRyYW5zbGF0aW9ucykubWFwKChbbG9jYWxlLCBkYXRhXSkgPT4gKFxuICAgICAgICAgICAgICAgICAgICBgPHNjcmlwdCB0eXBlPVwiZ2VuZXJhdGVkLXRyYW5zbGF0aW9uc1wiIGRhdGEtbG9jYWxlPVwiJHtsb2NhbGV9XCI+JHtKU09OLnN0cmluZ2lmeShkYXRhKX08L3NjcmlwdD5gXG4gICAgICAgICAgICAgICAgKSksXG4gICAgICAgICAgICAgICAgJzwhLS0gTDEwTl9FTkQgLS0+J1xuICAgICAgICAgICAgXS5tYXAobGluZSA9PiBgICAgICR7bGluZX1gKS5qb2luKCdcXG4nKVxuICAgICAgICApXG4gICAgICAgIC5yZXBsYWNlKFxuICAgICAgICAgICAgLzxzY3JpcHQgdHlwZT1cImdlbmVyYXRlZC1sb2NhbGUtbmFtZXNcIj5bXFxzXFxTXSs/PFxcL3NjcmlwdD4vLFxuICAgICAgICAgICAgYDxzY3JpcHQgdHlwZT1cImdlbmVyYXRlZC1sb2NhbGUtbmFtZXNcIj4ke0pTT04uc3RyaW5naWZ5KGxvY2FsZU5hbWVzKX08L3NjcmlwdD5gXG4gICAgICAgICk7XG4gICAgZnMud3JpdGVGaWxlU3luYyhpbmRleEh0bWwsIG5ld0NvbnRlbnQpO1xuXG4gICAgY29uc3Qgc3RvcmVMaXN0aW5ncyA9IGF3YWl0IHB1bGxSZXNvdXJjZSgnc3RvcmUtbGlzdGluZ3N5YW1sJywgMSk7XG4gICAgZnMud3JpdGVGaWxlU3luYyhcbiAgICAgICAgcGF0aFV0aWwuam9pbihkZXNrdG9wLCAnc3RvcmUtbGlzdGluZ3MvaW1wb3J0ZWQuanNvbicpLFxuICAgICAgICBKU09OLnN0cmluZ2lmeShzdG9yZUxpc3RpbmdzLCBudWxsLCA0KVxuICAgICk7XG59O1xuXG5jb25zdCBwdWxsRXh0ZW5zaW9ucyA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBleHRlbnNpb25zID0gcGF0aFV0aWwuam9pbihfX2Rpcm5hbWUsICcuLi8uLi9leHRlbnNpb25zJyk7XG4gICAgaWYgKCFpc0RpcmVjdG9yeVN5bmMoZXh0ZW5zaW9ucykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NraXBwaW5nIGV4dGVuc2lvbnM7IGNvdWxkIG5vdCBmaW5kIGV4dGVuc2lvbnMuJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBtZXRhZGF0YVRyYW5zbGF0aW9ucyA9IGF3YWl0IHB1bGxSZXNvdXJjZSgnZXh0ZW5zaW9uLW1ldGFkYXRhJywgMCk7XG4gICAgZnMud3JpdGVGaWxlU3luYyhcbiAgICAgICAgcGF0aFV0aWwuam9pbihleHRlbnNpb25zLCAndHJhbnNsYXRpb25zL2V4dGVuc2lvbi1tZXRhZGF0YS5qc29uJyksXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KG1ldGFkYXRhVHJhbnNsYXRpb25zLCBudWxsLCA0KVxuICAgICk7XG5cbiAgICBjb25zdCBydW50aW1lVHJhbnNsYXRpb25zID0gYXdhaXQgcHVsbFJlc291cmNlKCdleHRlbnNpb25zJywgMCk7XG4gICAgZnMud3JpdGVGaWxlU3luYyhcbiAgICAgICAgcGF0aFV0aWwuam9pbihleHRlbnNpb25zLCAndHJhbnNsYXRpb25zL2V4dGVuc2lvbi1ydW50aW1lLmpzb24nKSxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkocnVudGltZVRyYW5zbGF0aW9ucywgbnVsbCwgNClcbiAgICApO1xufTtcblxuY29uc3QgcHVsbEV2ZXJ5dGhpbmcgPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coJ0RPV05MT0FESU5HIGZyb20gVHJhbnNpZmV4Li4uJyk7XG4gICAgICAgIGF3YWl0IHB1bGxHdWkoKTtcbiAgICAgICAgYXdhaXQgcHVsbFBhY2thZ2VyKCk7XG4gICAgICAgIGF3YWl0IHB1bGxEZXNrdG9wKCk7XG4gICAgICAgIGF3YWl0IHB1bGxFeHRlbnNpb25zKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxufTtcblxucHVsbEV2ZXJ5dGhpbmcoKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFFQSxPQUFP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QztFQUNqRTNELEVBQUUsQ0FBQytGLGFBQWEsQ0FDWmhHLFFBQVEsQ0FBQ3NELElBQUksQ0FBQzZELE9BQU8sRUFBRSw4QkFBOEIsQ0FBQyxFQUN0RGxCLElBQUksQ0FBQ0MsU0FBUyxDQUFDdUIsYUFBYSxFQUFFLElBQUksRUFBRSxDQUFDLENBQ3pDLENBQUM7QUFDTCxDQUFDO0FBRUQsTUFBTUMsY0FBYyxHQUFHLE1BQUFBLENBQUEsS0FBWTtFQUMvQixNQUFNQyxVQUFVLEdBQUczSCxRQUFRLENBQUNzRCxJQUFJLENBQUN1QyxTQUFTLEVBQUUsa0JBQWtCLENBQUM7RUFDL0QsSUFBSSxDQUFDWixlQUFlLENBQUMwQyxVQUFVLENBQUMsRUFBRTtJQUM5QmpFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGlEQUFpRCxDQUFDO0lBQzlEO0VBQ0o7RUFFQSxNQUFNaUUsb0JBQW9CLEdBQUcsTUFBTWhFLFlBQVksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLENBQUM7RUFDeEUzRCxFQUFFLENBQUMrRixhQUFhLENBQ1poRyxRQUFRLENBQUNzRCxJQUFJLENBQUNxRSxVQUFVLEVBQUUsc0NBQXNDLENBQUMsRUFDakUxQixJQUFJLENBQUNDLFNBQVMsQ0FBQzBCLG9CQUFvQixFQUFFLElBQUksRUFBRSxDQUFDLENBQ2hELENBQUM7RUFFRCxNQUFNQyxtQkFBbUIsR0FBRyxNQUFNakUsWUFBWSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUM7RUFDL0QzRCxFQUFFLENBQUMrRixhQUFhLENBQ1poRyxRQUFRLENBQUNzRCxJQUFJLENBQUNxRSxVQUFVLEVBQUUscUNBQXFDLENBQUMsRUFDaEUxQixJQUFJLENBQUNDLFNBQVMsQ0FBQzJCLG1CQUFtQixFQUFFLElBQUksRUFBRSxDQUFDLENBQy9DLENBQUM7QUFDTCxDQUFDO0FBRUQsTUFBTUMsY0FBYyxHQUFHLE1BQUFBLENBQUEsS0FBWTtFQUMvQixJQUFJO0lBQ0FwRSxPQUFPLENBQUNDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQztJQUM1QyxNQUFNZ0MsT0FBTyxDQUFDLENBQUM7SUFDZixNQUFNVSxZQUFZLENBQUMsQ0FBQztJQUNwQixNQUFNYSxXQUFXLENBQUMsQ0FBQztJQUNuQixNQUFNUSxjQUFjLENBQUMsQ0FBQztFQUMxQixDQUFDLENBQUMsT0FBT3BDLENBQUMsRUFBRTtJQUNSNUIsT0FBTyxDQUFDa0IsS0FBSyxDQUFDVSxDQUFDLENBQUM7SUFDaEJuQyxPQUFPLENBQUM0RSxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ25CO0FBQ0osQ0FBQztBQUVERCxjQUFjLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["pathUtil","fs","txPull","txGetResourceStatistics","supportedLocales","scratchToTransifex","batchMap","PROJECT","CONCURRENCY_LIMIT","SOURCE_LOCALE","normalizeMessages","messages","result","id","Object","keys","sort","string","removeRedundantMessages","localeMessages","sourceMessages","messageId","messageContent","entries","sourceString","nested","length","createProgressPrinter","locales","RESET","BOLD","GRAY","BLUE","GREEN","CLEAR","NOT_STARTED","STARTED","FINISHED","ended","states","locale","print","items","map","state","color","total","totalFinished","values","filter","i","process","stdout","write","join","startedItem","finishedItem","end","console","log","pullResource","resource","requiredCompletion","transifexStatistics","totalStrings","threshold","Math","max","round","localesToFetch","transifexLocale","translatedStrings","Error","name","progress","scratchLocale","error","find","pulled","slimmedMessages","toLowerCase","isDirectorySync","path","stat","statSync","isDirectory","e","code","generateSmallestLocaleNamesMap","lowercaseSupportedLocales","value","pullGui","scratchGui","__dirname","guiTranslationsFile","guiTranslations","writeFileSync","JSON","stringify","addonsTranslationsFile","addonsTranslations","pullPackager","packager","translations","localesDirectory","readdirSync","endsWith","unlinkSync","index","oldContent","readFileSync","newContent","replace","localeNames","pullDesktop","desktop","desktopTranslations","webTranslations","indexHtml","data","line","storeListings","pullExtensions","extensions","metadataTranslations","runtimeTranslations","pullEverything","exit"],"sourceRoot":"C:\\Users\\Administrator\\source\\repos\\PerfectMYGHY\\scratch\\node_modules\\scratch-gui\\node_modules\\@turbowarp\\scratch-l10n\\scripts\\","sources":["tw-pull.js"],"sourcesContent":["#!/usr/bin/env babel-node\n\nimport pathUtil from 'node:path';\nimport fs from 'node:fs';\nimport {txPull, txGetResourceStatistics} from '../lib/transifex';\nimport {supportedLocales, scratchToTransifex} from './tw-locales';\nimport {batchMap} from '../lib/batch.js';\n\n/* eslint-disable valid-jsdoc */\n\nconst PROJECT = 'turbowarp';\nconst CONCURRENCY_LIMIT = 36;\nconst SOURCE_LOCALE = 'en';\n\n/**\n * Not sure how to do this in JSDoc\n * @template T\n * @typedef {Record<string, T>} NestedRecord<T>\n */\n\n/**\n * Normalizes messages in the following ways by converting objects with context to just strings,\n * and ensures that the order of keys is consistent.\n * @param {NestedRecord<string | {string: string}>} messages\n * @returns {NestedRecord<string>}\n */\nconst normalizeMessages = messages => {\n    const result = {};\n    for (const id of Object.keys(messages).sort()) {\n        const string = messages[id];\n        if (typeof string === 'string') {\n            // Don't touch normal strings.\n            result[id] = string;\n        } else if (typeof string.string === 'string') {\n            // Convert structured strings with context to normal strings.\n            result[id] = string.string;\n        } else {\n            // Recurse into nested message objects.\n            result[id] = normalizeMessages(string);\n        }\n    }\n    return result;\n};\n\n/**\n * @param {NestedRecord<string>} localeMessages\n * @param {NestedRecord<string>} sourceMessages\n * @returns {NestedRecord<string>}\n */\nconst removeRedundantMessages = (localeMessages, sourceMessages) => {\n    const result = {};\n    for (const [messageId, messageContent] of Object.entries(localeMessages)) {\n        const string = messageContent;\n        const sourceString = sourceMessages[messageId];\n        if (typeof string === 'string') {\n            // Copy strings that do not exactly match their English counterpart.\n            if (string !== sourceString) {\n                result[messageId] = string;\n            }\n        } else {\n            // Recurse into nested objects.\n            const nested = removeRedundantMessages(string, sourceString);\n            if (Object.keys(nested).length !== 0) {\n                result[messageId] = nested;\n            }\n        }\n    }\n    return result;\n};\n\n/**\n * @param {string[]} locales\n */\nconst createProgressPrinter = locales => {\n    const RESET = `\\u001b[0m`;\n    const BOLD = `\\u001b[1m`;\n    const GRAY = '\\u001b[90m';\n    const BLUE = `\\u001b[34m`;\n    const GREEN = '\\u001b[32m';\n    const CLEAR = '\\u001b[0k';\n\n    const NOT_STARTED = 0;\n    const STARTED = 1;\n    const FINISHED = 2;\n\n    let ended = false;\n    const states = {};\n    for (const locale of locales) {\n        states[locale] = NOT_STARTED;\n    }\n\n    const print = () => {\n        if (ended) {\n            return;\n        }\n        const items = Object.entries(states).map(([locale, state]) => {\n            let color = '??';\n            if (state === NOT_STARTED) color = GRAY;\n            if (state === STARTED) color = BLUE;\n            if (state === FINISHED) color = BOLD + GREEN;\n            return `${color}${locale}${RESET}`;\n        });\n        const total = locales.length;\n        const totalFinished = Object.values(states).filter(i => i === FINISHED).length;\n        process.stdout.write(`\\r${CLEAR}${items.join(' ')}${RESET} ${totalFinished}/${total}`);\n    };\n\n    const startedItem = locale => {\n        states[locale] = STARTED;\n        print();\n    };\n\n    const finishedItem = locale => {\n        states[locale] = FINISHED;\n        print();\n    };\n\n    const end = () => {\n        ended = true;\n        // Move cursor to own line.\n        console.log('');\n    };\n\n    print();\n    return {\n        startedItem,\n        finishedItem,\n        end\n    };\n};\n\n/**\n * @param {string} resource Name of Transifex resource\n * @param {number} requiredCompletion Number from 0-1 indicating what % of strings must be translated.\n *  Locales that do not meet this threshold will not be included in the result.\n * @returns {Promise<Record<string, Record<string, string>>} Does not include source messages.\n */\nconst pullResource = async (resource, requiredCompletion) => {\n    console.log(`Pulling ${resource}...`);\n\n    const transifexStatistics = await txGetResourceStatistics(PROJECT, resource);\n    const totalStrings = transifexStatistics[SOURCE_LOCALE];\n    const threshold = Math.max(1, Math.round(totalStrings * requiredCompletion));\n    const localesToFetch = Object.keys(supportedLocales).filter(locale => {\n        const transifexLocale = scratchToTransifex[locale] || locale;\n        const translatedStrings = transifexStatistics[transifexLocale];\n        if (typeof translatedStrings !== 'number') {\n            throw new Error(`Missing locale ${supportedLocales[locale].name} (${locale}) in ${resource}`);\n        }\n        return translatedStrings >= threshold;\n    });\n\n    const progress = createProgressPrinter(localesToFetch);\n\n    const values = await batchMap(localesToFetch, CONCURRENCY_LIMIT, async locale => {\n        progress.startedItem(locale);\n        try {\n            const messages = await txPull(PROJECT, resource, scratchToTransifex[locale] || locale);\n            progress.finishedItem(locale);\n            return {\n                scratchLocale: locale,\n                messages: normalizeMessages(messages)\n            };\n        } catch (error) {\n            progress.end();\n            // Transifex's error messages sometimes lack enough detail, so we will include\n            // some extra information.\n            console.error(`Could not fetch messages for locale: ${locale}`);\n            throw error;\n        }\n    });\n\n    const sourceMessages = values.find(i => i.scratchLocale === SOURCE_LOCALE).messages;\n    const result = {};\n    for (const pulled of values) {\n        const slimmedMessages = removeRedundantMessages(pulled.messages, sourceMessages);\n        if (Object.keys(slimmedMessages).length > 0) {\n            result[pulled.scratchLocale.toLowerCase()] = slimmedMessages;\n        }\n    }\n\n    progress.end();\n    return result;\n};\n\n/**\n * @param {string} path\n * @returns {boolean}\n */\nconst isDirectorySync = path => {\n    try {\n        const stat = fs.statSync(path);\n        return stat.isDirectory();\n    } catch (e) {\n        if (e.code === 'ENOENT') {\n            return false;\n        }\n        throw e;\n    }\n};\n\n/**\n * @param {NestedRecord<string, string>} messages\n * @returns {Record<string, string>}\n */\nconst generateSmallestLocaleNamesMap = messages => {\n    const lowercaseSupportedLocales = {};\n    for (const [locale, value] of Object.entries(supportedLocales)) {\n        lowercaseSupportedLocales[locale.toLowerCase()] = value;\n    }\n    const result = {\n        [SOURCE_LOCALE]: supportedLocales[SOURCE_LOCALE].name\n    };\n    for (const locale of Object.keys(messages)) {\n        result[locale] = lowercaseSupportedLocales[locale].name;\n    }\n    return result;\n};\n\nconst pullGui = async () => {\n    const scratchGui = pathUtil.join(__dirname, '../../scratch-gui');\n    if (!isDirectorySync(scratchGui)) {\n        console.log('Skipping editor; could not find scratch-gui.');\n        return;\n    }\n\n    const guiTranslationsFile = pathUtil.join(scratchGui, 'src/lib/tw-translations/generated-translations.json');\n    // These translations build upon scratch-l10n, so the threshold should be 0.\n    const guiTranslations = await pullResource('guijson', 0);\n    fs.writeFileSync(guiTranslationsFile, JSON.stringify(guiTranslations, null, 4));\n\n    const addonsTranslationsFile = pathUtil.join(scratchGui, 'src/addons/settings/translations.json');\n    const addonsTranslations = await pullResource('addonsjson', 0.7);\n    fs.writeFileSync(addonsTranslationsFile, JSON.stringify(addonsTranslations, null, 4));\n};\n\nconst pullPackager = async () => {\n    const packager = pathUtil.join(__dirname, '../../packager');\n    if (!isDirectorySync(packager)) {\n        console.log('Skipping packager; could not find packager.');\n        return;\n    }\n\n    const translations = await pullResource('packagerjson', 0.5);\n\n    // Delete old JSON files. Some languages that were previously supported might no longer be.\n    const localesDirectory = pathUtil.join(packager, 'src', 'locales');\n    for (const name of fs.readdirSync(localesDirectory)) {\n        if (name.endsWith('.json') && name !== 'en.json') {\n            fs.unlinkSync(pathUtil.join(localesDirectory, name));\n        }\n    }\n\n    // Write the individual JSON files\n    for (const [locale, messages] of Object.entries(translations)) {\n        const path = pathUtil.join(localesDirectory, `${locale}.json`);\n        fs.writeFileSync(path, JSON.stringify(messages, null, 4));\n    }\n\n    // Write the index.js manifest\n    const index = pathUtil.join(localesDirectory, 'index.js');\n    const oldContent = fs.readFileSync(index, 'utf-8');\n    const newContent = oldContent.replace(/\\/\\*===\\*\\/[\\s\\S]+\\/\\*===\\*\\//m, `/*===*/\\n${\n        Object.keys(translations)\n            .map(i => `  ${JSON.stringify(i)}: () => require(${JSON.stringify(`./${i}.json`)})`)\n            .join(',\\n')\n    },\\n  /*===*/`);\n    fs.writeFileSync(index, newContent);\n\n    // Write locale-names.json\n    const localeNames = generateSmallestLocaleNamesMap(translations);\n    fs.writeFileSync(pathUtil.join(localesDirectory, 'locale-names.json'), JSON.stringify(localeNames, null, 4));\n};\n\nconst pullDesktop = async () => {\n    const desktop = pathUtil.join(__dirname, '../../turbowarp-desktop');\n    if (!isDirectorySync(desktop)) {\n        console.log('Skipping desktop; could not find turbowarp-desktop.');\n        return;\n    }\n\n    // Desktop app translations\n    const desktopTranslations = await pullResource('desktopnewjson', 0.5);\n    fs.writeFileSync(\n        pathUtil.join(desktop, 'src-main/l10n/generated-translations.json'),\n        JSON.stringify(desktopTranslations, null, 4)\n    );\n\n    // Website translations\n    const webTranslations = await pullResource('desktopturbowarporg-redesign', 0.7);\n    const localeNames = generateSmallestLocaleNamesMap(webTranslations);\n    const indexHtml = pathUtil.join(desktop, 'docs', 'index.html');\n    const oldContent = fs.readFileSync(indexHtml, 'utf-8');\n    const newContent = oldContent\n        .replace(\n            / *<!-- L10N_START -->[\\s\\S]*?<!-- L10N_END -->/gm,\n            [\n                '<!-- L10N_START -->',\n                ...Object.entries(webTranslations).map(([locale, data]) => (\n                    `<script type=\"generated-translations\" data-locale=\"${locale}\">${JSON.stringify(data)}</script>`\n                )),\n                '<!-- L10N_END -->'\n            ].map(line => `    ${line}`).join('\\n')\n        )\n        .replace(\n            /<script type=\"generated-locale-names\">[\\s\\S]+?<\\/script>/,\n            `<script type=\"generated-locale-names\">${JSON.stringify(localeNames)}</script>`\n        );\n    fs.writeFileSync(indexHtml, newContent);\n\n    const storeListings = await pullResource('store-listingsyaml', 1);\n    fs.writeFileSync(\n        pathUtil.join(desktop, 'store-listings/imported.json'),\n        JSON.stringify(storeListings, null, 4)\n    );\n};\n\nconst pullExtensions = async () => {\n    const extensions = pathUtil.join(__dirname, '../../extensions');\n    if (!isDirectorySync(extensions)) {\n        console.log('Skipping extensions; could not find extensions.');\n        return;\n    }\n\n    const metadataTranslations = await pullResource('extension-metadata', 0);\n    fs.writeFileSync(\n        pathUtil.join(extensions, 'translations/extension-metadata.json'),\n        JSON.stringify(metadataTranslations, null, 4)\n    );\n\n    const runtimeTranslations = await pullResource('extensions', 0);\n    fs.writeFileSync(\n        pathUtil.join(extensions, 'translations/extension-runtime.json'),\n        JSON.stringify(runtimeTranslations, null, 4)\n    );\n};\n\nconst pullEverything = async () => {\n    try {\n        console.log('DOWNLOADING from Transifex...');\n        await pullGui();\n        await pullPackager();\n        await pullDesktop();\n        await pullExtensions();\n    } catch (e) {\n        console.error(e);\n        process.exit(1);\n    }\n};\n\npullEverything();\n"],"mappings":"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","ignoreList":[]}},"mtime":1713531134916}}